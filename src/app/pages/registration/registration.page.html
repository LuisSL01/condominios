<app-header titulo="Crear cuenta"></app-header>
<ion-content fullscreen>

  <form [formGroup]="createAgente" (ngSubmit)="guardarDatos()">

    <ion-list>

      <ion-item>
        <ion-label>
          <ion-icon name="person-outline" style="font-size:23px; color: #50c8ec; 
              margin-bottom: -5px;
          "></ion-icon>&nbsp;&nbsp;Nombre completo:
        </ion-label>
        <ion-input formControlName="nombreCompleto"></ion-input>
      </ion-item>
      <ion-label color="danger"
        *ngIf="createAgente.controls.nombreCompleto.errors?.required && (createAgente.controls.nombreCompleto.touched || createAgente.controls.nombreCompleto.dirty)">
        *
        El
        nombre es obligatorio </ion-label>
      <ion-label color="danger"
        *ngIf="createAgente.controls.nombreCompleto.errors?.minlength && (createAgente.touched || createAgente.dirty)">*
        El nombre tiene que tener al menos 4 caracteres.</ion-label>

      <ion-item>
        <ion-label>
          <ion-icon name="person-outline" style="font-size:23px; color: #50c8ec; 
                margin-bottom: -5px;
            "></ion-icon>&nbsp;&nbsp;Ap. Paterno:
        </ion-label>
        <ion-input formControlName="apellidoPaterno"></ion-input>
      </ion-item>


      <ion-item>
        <ion-label>
          <ion-icon name="person-outline" style="font-size:23px; color: #50c8ec; 
                margin-bottom: -5px;
            "></ion-icon>&nbsp;&nbsp;Ap. Materno:
        </ion-label>
        <ion-input formControlName="apellidoMaterno"></ion-input>
      </ion-item>

      <ion-item>
        <ion-label>
          <ion-icon name="transgender-outline" style="font-size:23px; color: #50c8ec; margin-bottom: -5px;">
          </ion-icon>&nbsp;&nbsp;Sexo
        </ion-label>
        <ion-select interface="popover" placeholder="Seleccionar" formControlName="sexo" okText="Aceptar"
          cancelText="Cancelar">
          <ion-select-option value="Masculino">Masculino</ion-select-option>
          <ion-select-option value="Femenino">Femenino</ion-select-option>
          <ion-select-option value="Otro">Otro</ion-select-option>
        </ion-select>
      </ion-item>


      <ion-item>
        <ion-label>
          <ion-icon name="today-outline" style="font-size:23px; color: #50c8ec; margin-bottom: -5px;">
          </ion-icon>&nbsp;&nbsp;Fecha de nacimiento
        </ion-label>
        <ion-datetime style="margin-bottom: -8px;" placeholder="DD/MM/YYYY" displayFormat="DD/MM/YYYY"
          cancelText="Descartar" doneText="Aceptar" formControlName="fechaDeNacimiento">
        </ion-datetime>
      </ion-item>

      <ion-item>
        <ion-label>
          <ion-icon name="tv-outline" style="font-size:23px; color: #50c8ec; 
                margin-bottom: -5px;
            "></ion-icon>&nbsp;&nbsp;Ocupación:
        </ion-label>
        <ion-input formControlName="ocupacion"></ion-input>
      </ion-item>



      <ion-item>
        <ion-label>
          <ion-icon name="mail-outline" style="font-size:23px; color: #50c8ec; margin-bottom: -5px;"></ion-icon>
          &nbsp;&nbsp;Celular:
        </ion-label>
        <ion-input (ionChange)="cambioNumeroTelefono( $event )" formControlName="celular"></ion-input>
      </ion-item>



      <ion-item>

        <ion-label>
          <ion-icon name="mail-outline" style="font-size:23px; color: #50c8ec; 
              margin-bottom: -5px;
          "></ion-icon>&nbsp;&nbsp;Email:
        </ion-label>
        <ion-input formControlName="email"></ion-input>
      </ion-item>
      <ion-label color="danger"
        *ngIf="createAgente.controls.email.errors?.email && (createAgente.touched || createAgente.dirty)">* El email no
        es válido.</ion-label>
      <ion-item>
        <ion-label>
          <ion-icon name="person-outline" style="font-size:23px; color: #50c8ec; 
                margin-bottom: -5px;
            "></ion-icon>&nbsp;&nbsp;Usuario:
        </ion-label>
        <ion-input formControlName="username"  (ionChange)="cambioUsuario( $event )" ></ion-input>
      </ion-item>
      <ion-label color="danger"
        *ngIf="createAgente.controls.username.errors?.required && (createAgente.touched || createAgente.dirty)">* El
        usuario es obligatorio </ion-label>
      <ion-label color="danger"
        *ngIf="createAgente.controls.username.errors?.minlength && (createAgente.touched || createAgente.dirty)">* El
        usuario tiene que tener al menos 4 caracteres.</ion-label>

      <ion-item>
        <ion-label>
          <ion-icon name="lock-closed" style="font-size:23px; color: #50c8ec; 
                margin-bottom: -5px;
            "></ion-icon>&nbsp;&nbsp;Contraseña:
        </ion-label>
        <ion-input type="password" placeholder="Contraseña" formControlName="password" autocomplete="off"></ion-input>
      </ion-item>
      <ion-label color="danger"
        *ngIf="createAgente.controls.password.errors?.required && (createAgente.touched || createAgente.dirty)">* La
        contraseña es requerida </ion-label>

      <ion-item>
        <ion-label>
          <ion-icon name="lock-closed" style="font-size:23px; color: #50c8ec; 
                margin-bottom: -5px;
            "></ion-icon>&nbsp;&nbsp;Repetir Contraseña:
        </ion-label>

        <ion-input type="password" placeholder="Repetir Contraseña" formControlName="confirmarPassword"
          autocomplete="off"></ion-input>

      </ion-item>
      <ion-label color="danger"
        *ngIf="createAgente.controls.confirmarPassword.errors?.required && (createAgente.controls.confirmarPassword.touched || createAgente.controls.confirmarPassword.dirty)">
        *La confirmación de contraseña es requerida </ion-label>
      <div formGroupName="direccion" *ngIf="false">
        <ion-item>

          <ion-label>
            <ion-icon name="home-outline" style="font-size:23px; color: #50c8ec; 
                margin-bottom: -5px;
            "></ion-icon>&nbsp;&nbsp;Domicilio:
          </ion-label>


          <ion-input type="text" class="form-control" formControlName="calle" id="calle" placeholder="Domicilio">
          </ion-input>
        </ion-item>
        <div
          *ngIf="createAgente.get('direccion').get('calle').invalid && (createAgente.get('direccion').get('calle').dirty || createAgente.get('direccion').get('calle').touched)">
          <div *ngIf="createAgente.get('direccion').get('calle').errors['required']">
            La dirección es requerida.
          </div>
        </div>

        <ion-item>
          <ion-label>
            <ion-icon name="home-outline" style="font-size:23px; color: #50c8ec; 
                margin-bottom: -5px;
            "></ion-icon>&nbsp;&nbsp;Código Postal:
          </ion-label>
          <ion-input type="text" maxlength="5" class="form-control" formControlName="asentamiento" placeholder="CP">
          </ion-input>
        </ion-item>
        <div
          *ngIf="createAgente.get('direccion').get('asentamiento').invalid && (createAgente.get('direccion').get('asentamiento').dirty || createAgente.get('direccion').get('asentamiento').touched)">
          <ion-label color="danger" *ngIf="createAgente.get('direccion').get('asentamiento').errors['required']">
            * El código postal es requerido
          </ion-label>
        </div>

        <ion-button (click)="validarCP()" expand="block" shape="round">
          Validar código postal
        </ion-button>


        <ion-item>
          <ion-label>
            <ion-icon name="home-outline" style="font-size:23px; color: #50c8ec; 
                margin-bottom: -5px;
            "></ion-icon>&nbsp;&nbsp;Asentamiento:
          </ion-label>
          <ion-select interface="action-sheet" cancelText="Cancelar" placeholder="Seleccionar" required
            (ionChange)="cambioAsentamiento($event)">
            <ion-select-option *ngFor="let asento of asentamientos" [value]="asento">
              {{ asento.colonia }}-{{ asento.municipio}}--{{asento.estado}}
            </ion-select-option>
          </ion-select>

        </ion-item>


      </div>

      <ion-item>
        <ion-label>
          <ion-icon name="leaf-outline" style="font-size:23px; color: #50c8ec; 
              margin-bottom: -5px;
          "></ion-icon>&nbsp;&nbsp;Residencia:
        </ion-label>
        <ion-select interface="action-sheet" cancelText="Cancelar" placeholder="Seleccionar" required
          (ionChange)="cambioEmpresa($event)">
          <ion-select-option *ngFor="let emp of empresas" [value]="emp.id">
            {{ emp.nombre}}
          </ion-select-option>
        </ion-select>
      </ion-item>


    </ion-list>


    <app-buttons valueLinkCancel="/home" valueDisabled="{{ ! createAgente.valid}}"></app-buttons>
    <app-footer></app-footer>

  </form>
</ion-content>